# 其他
1. 什什么是幂等？什什么情况下需要考虑幂等？你怎么解决幂等的问题？  
> 一次请求的结果和多次请求的结果是一样的,不会出现重复等等  
> 例如重复提交,这个就是不幂等的
# Java
1. 多个线程同时读写，读线程的数量量远远⼤大于写线程，你认为应该如何解决
  并发的问题？你会选择加什什么样的锁？
> 读写锁,因为读不会阻塞写,但是写会阻塞读,这样会大大减少脏数据出现的概率

2. JAVA的AQS是否了了解，它是⼲干嘛的？  
> 队列同步器,里面全称AbstractQueuedSynchronized,该队列提供了一个独占锁和共享所,其中AQS维护了一个state变量字段,可以看作是资源数量.head和tail代表等待队列。
>
> **独占锁运行流程:**
>
> 1. 当线程1抢占锁的时候,会将当前独占的标识设置为该线程,并且将资源的状态设置+1
>
> 2. 当线程2抢占的时候,发现state不为0,表示已经有了持锁的人.
>
> 3. 这时候还是会先进行尝试的获取一次,如果是持锁人,则state累加1。
>
> 4. 如果尝试还是抢不到,则会将当前线程包装成一个node节点,添加到队列中.
>
>    1. 如果tail和head都为空,则会进行初始化流程,对应的方法叫enq方法。
>
>       1. 会先初始化一个node,并且将当前线程的prev前继节点设置为新的node
>       2. 然后通过CAS将新的node设置成tail。
>       3. 然后将node的next设置成当前线程的节点,并且返回..
>
>       这里主要做的一件事情就是将头结点设置成当前线程,并返回,如果再来一个线程就加入到tail节点后面。主要就是构建一个队列。
>
> 5. 如果当前节点的上一个节点是head节点,则会进行一次尝试抢占,如果抢占到了,直接返回。因为到这一步基本上就说明队列中只剩下一个了。
>
>    1. 获取成功之后,别忘了,这个抢占到的只是前继节点.当前线程的节点呢?
>    2. 将当前节点放入到head中作为头结点,并且返回
>
> 6. 这时候开始观察队列中的节点,并且为当前线程找到一个可依靠的节点。、
>
>    **为什么会有这一步?**
>
>    1. 因为不确定队列中的其他节点是否有效
>    2. 如果当前线程排到一个无效节点的后面是没用的
>
> 7. 找到可依赖的前继节点之后,开始阻塞调用LockSupport.park(),等待唤醒。唤醒完成之后，又会回到第五步，因为这个中间是个自旋的操作
>
>    **唤醒流程:**
>
>       	1. 查询当前释放的线程是否是抢占者的线程
>         2. state-1>0的话直接返回不做处理
>          3. 当等于0的时候,表示锁已经被释放了,这时候需要让下一位持锁人释放锁
>          4. 这时候会找到它的head节点,并且判断head节点的状态,如果head节点有效,则直接唤醒head节点正在阻塞的线程。
>          5. 如果head的节点是无效的。则开始从tail中向上查找。一直找最靠前并且状态是有效的。找到之后直接唤醒。唤醒完成之后回到上面的第7步骤



3. 除了了synchronized关键字之外，你是怎么来保障线程安全的？
> 也可以使用ReentrantLock。当然通过CAS也是可以做类似原子性操作的。

3. 什什么时候需要加volatile关键字？它能保证线程安全吗？

> 当线程间需要通信的时候，比如多个线程访问一个变量，它并不能保证线程安全。因为它只能保证线程间可见。如果你想做原子性操作是行不通的还是得加锁。

3. **线程池内的线程如果全部忙，提交⼀一个新的任务，会发⽣生什什么？队列列全部**
  **塞满了了之后，还是忙，再提交会发⽣生什什么？**

> 1. 加入到阻塞队列中。
>
> 2. 全部塞满了之后会触发它的一个RejectedExecutionHandler接口的回调吧。
>
>    ​

3. **Tomcat本身的参数你⼀一般会怎么调整？**

> 一般会调整它的线程池的大小吧,因为这个对并发有影响。

3. synchronized关键字锁住的是什什么东⻄西？在字节码中是怎么表示的？在内
  存中的对象上表现为什什么？

> 1. 如果synchronized修饰的是方法,则锁住的范围是在这个实例
> 2. 修饰的是静态方法的话,锁主的就是当前字节码对象
> 3. 如果修饰的是方法块?则锁住的是当前传入的对象
>
> **字节码**
>
>    	1. synchronized在字节码中对应的是monintenter和monintorExit。
>      2. ​

3. wait/notify/notifyAll⽅方法需不不需要被包含在synchronized块中？这是为什什
  么？

> 需要。因为这些方法都是需要先获取到对象的锁的。如果获取不到的话会报异常。IllegalMonitorStateException异常

3. ExecutorService你⼀一般是怎么⽤用的？是每个service放⼀一个还是⼀一个项⽬目
  ⾥里里⾯面放⼀一个？有什什么好处？

> 一个应用一个吧,相当于一个单例.因为本身就是一个线程池.定义一个就好了,需要线程就到线程池里面去拿,就类似与数据库连接池一样。

# Spring
1. 你有没有⽤用过Spring的AOP? 是⽤用来⼲干嘛的? ⼤大概会怎么使⽤用？
> 用过。用来做切面的。
>
> 减少代码之间的耦合度,并且能够大量的减少一些开发量。
>
> 一般的应用场景有事务、日志、权限控制等等一系列的操作

2. 如果⼀一个接⼝口有2个不不同的实现, 那么怎么来Autowire⼀一个指定的实现？

> Spring中有一个@Qulifar注解,他能够用来指定你想要的实现类

3. Spring的声明式事务 @Transaction注解⼀一般写在什什么位置? 抛出了了异常

会⾃自动回滚吗？有没有办法控制不不触发回滚?

> 可以写到类上,也可以写到方法上,我们一般是写到方法上,粒度更细
>
> 看什么异常,如果是Runtime和异常是肯定会回滚的,其他的异常可以有参数指定
>
> 事务的传播级别中有一个nested的级别,如果你在报异常的时候,进行捕获的话,是不会回滚的
>
> 又或者说,你调用的方法都是required_new类型的,每次执行都是一个新的事务,互不影响。



4. **如果想在某个Bean⽣生成并装配完毕后执行自⼰的逻辑，可以什什么方式实**

**现？**

> 

5. SpringBoot没有放到web容器器⾥里里为什什么能跑HTTP服务？

> 因为它内嵌了tomcat的方式进行的管理

6. SpringBoot中如果你想使⽤用⾃自定义的配置⽂文件⽽而不不仅仅是

application.properties，应该怎么弄弄？

> 在启动类上加上一个@ImportResource()方法

7. SpringMVC中RequestMapping可以指定GET, POST⽅方法么？怎么指定？

> 可以。Method = RequestMethod.POST

8. SpringMVC如果希望把输出的Object(例例如XXResult或者XXResponse)这

种包装为JSON输出, 应该怎么处理理?

> @ResponseBody -> 这个表示以json方式进行输出
>
> @RequestBody -> 这个表示以json的方式进行接收

7. 怎样拦截SpringMVC的异常，然后做⾃自定义的处理理，⽐比如打⽇日志或者包装
  成JSON

> 基于注解的方式有
>
> @ControllerAdvice 配合 @ExceptionHandler({Exception.class})里面对应的异常信息,前提是你controller必须要把异常往外抛出,因为SpringMVC是把这个请求都经过了封装

#  MySQL

1. 如果有很多数据插⼊入MYSQL 你会选择什什么⽅方式?
> 批量查询 , insert into table value()

2. 如果查询很慢，你会想到的第⼀一个⽅方式是什什么？索引是⼲干嘛的?

> 1. 加索引。 
> 2. 和java中的hashMap是一个道理,它能够根据本地生成的索引文件快速标识到查询条件范围内的记录

3. 如果建了了⼀一个单列列索引，查询的时候查出2列列，会⽤用到这个单列列索引吗？

> 会。索引字段会包含整条记录的位置

4. **如果建了了⼀一个包含多个列列的索引，查询的时候只⽤用了了第⼀一列列，能不不能⽤用上**

**这个索引？查三列列呢？**

> 

5. 接上题，如果where条件后⾯面带有⼀一个 i + 5 < 100 会使⽤用到这个索引吗？

> 不会。

6. 怎么看是否⽤用到了了某个索引？

> explain 

7. like %aaa%会使⽤用索引吗? like aaa%呢?

> 前一个不会，后一个会

8. drop、truncate、delete的区别？

> truncate 不会锁表,delete 会删掉和条件相关的,drop会直接删掉整张表

9. 平时你们是怎么监控数据库的? 慢SQL是怎么排查的？

> 阿里云吧
>
> 1. mysql里面有一个配置超时时间会记录日志的参数
> 2. 通过druid连接池也可以监控到,他有一个监控页面
> 3. 可以在DB层做一些植入

10. 你们数据库是否⽀支持emoji表情，如果不不⽀支持，如何操作?

> 普通的字符集是不支持的,需要使用一个特定的字符集才能够保存

11. 你们的数据库单表数据量量是多少？⼀一般多⼤大的时候开始出现查询性能急

剧下降？

> 一千万吧。
>
> 多大的时候会出现查询性能急剧下降? 这个可能和服务器的配置息息相关,
>
> 我们目前这家公司配置不怎么样,可能在500万左右就开始那个啥了...
>
> 上上家公司的话配置挺好的,可能到千万级才会出现急剧下降..

12. **查询死掉了了，想要找出执⾏行行的查询进程⽤用什什么命令？找出来之后⼀一般你**

**会⼲干嘛？**

> 通过show processList;查询吧 ? 
>
> 找到这条记录的id直接kill掉吧 

13. 读写分离是怎么做的？你认为中间件会怎么来操作？这样操作跟事务有

什什么关系？

> mysql也可以做,应用程序也可以做,中间件也可以做。
>
> Mysql本身带有读写分离的配置的。这里可能就要涉及到一个主备的搭建了。
>
> 应用程序,先配置两个数据源一个读一个写的,然后根据一些操作类型进行切换。
>
> Mycat也可以做。
>
> 读写并发能力能够大量提升吧,一般只要关注写库吧,用读写分离一定要做主从复制的..

14. 分库分表有没有做过？线上的迁移过程是怎么样的？如何确定数据是正

确的？

> 分库分表就涉及到一个分片键的设计,通常最普通的有根据用户编号.如何去划分这个分库的方法有很多种,
>
> 比如 按时间，id范围，去摸等等一些常规的。
>
> 比较常用的分片算法有一致性hash吧,迁移的工作量会比较小,直需要关注相邻的节点做切分就OK了

# JVM

1. **你知道哪些或者你们线上使⽤用什什么GC策略略? 它有什什么优势，适⽤用于什什么**
  **场景？**
> 常用的有G1和CMS收集器。
>
> 1. G1会更加关注收集时间的长短
> 2. CMS更加关注

2. JAVA类加载器器包括⼏几种？它们之间的⽗父⼦子关系是怎么样的？双亲委派机

制是什什么意思？有什什么好处？

> 1. bootstrapClassload
> 2. ExtClassLoad
> 3. AppClassLoad
>
> 查找类的时候,先委托给父类,父类再往上找。
>
> 这样可以防止一些系统的类被破坏掉。比如说重写啊。安全性考虑吧

3. **如何⾃自定义⼀一个类加载器器？你使⽤用过哪些或者你在什什么场景下需要⼀一个⾃自**

**定义的类加载器器吗？**

> 继承一个ClassLoad方法，一般是重写那个findClass方法，然后通过Definclass加载到内存中

4. **堆内存设置的参数是什什么？**



5. **Perm Space中保存什什么数据? 会引起OutOfMemory吗？**

> final、state等等的数据。目前好像是不会了。

6. 做gc时，⼀一个对象在内存各个Space中被移动的顺序是什什么？

> eden -> surriver0 -> surriver1 -> old

7. **你有没有遇到过OutOfMemory问题？你是怎么来处理理这个问题的？处理理**

**过程中有哪些收获？**

> 目前遇见的比较少了，模拟的话就是不断的创建一个大对象吧 。。
>
> 可能通过一些第三方工具MAT去分析那个dump文件,查看最大文件。
>
> 在工作的时候对大对象的处理会谨慎一点。

8. **1.8之后Perm Space有哪些变动? MetaSpace⼤大⼩小默认是⽆无限的么? 还是**

**你们会通过什什么⽅方式来指定⼤大⼩小?**

> 有一个Meta Space区域。

9. **Jstack是⼲干什什么的? Jstat呢? 如果线上程序周期性地出现卡顿，你怀疑可**

**能是gc导致的，你会怎么来排查这个问题？线程⽇日志⼀一般你会看其中的什什么**
**部分？**



10. **StackOverFlow异常有没有遇到过？⼀一般你猜测会在什什么情况下被触**

**发？如何指定⼀一个线程的堆栈⼤大⼩小？⼀一般你们写多少？**

> 递归吧 .. 

# Linux命令
1. ⽇日志特别⼤大只想看最后100⾏行行怎么弄弄? 如果想⼀一直看⽇日志的持续输出，⽤用
  什什么命令?
> cat -行数f 文件名
>
> tail -行数f 文件名

1. **如果⽇日志⼀一边输出，⼀一边想实时看到有没有某个关键字应该怎么弄弄？**


1. **grep如果忽略略⼤大⼩小写应该怎么弄弄? 正则表达式呢？**
2. **vim往下⼀一⾏行行是什什么键？往下30⾏行行呢? 跳到⽂文件末尾⼀一⾏行行是什什么? 跳回来**
  **是什什么? 向后搜索是什什么?**
3. **如果有个⽂文本⽂文件，按空格作为列列的分隔符，如果想统计第三列列⾥里里⾯面的每**
  **个单词的出现次数应该怎么弄弄？**
4. **如果把上⾯面的出现次数排个序应该怎么弄弄? 想按照数字本身的顺序⽽而不不是**
  **字符串串的顺序排列列怎么弄弄？**
5. **Linux环境变量量是以什什么作为分隔符的？环境变量量通过什什么命令设置？**
6. **给某个⽂文件权设置限⽐比如设置为644 是⽤用什什么命令？这个6是什什么意思？**
7. **Linux下⾯面如果想看某个进程的资源占⽤用情况是怎么看的？系统load⼤大概**
  **指的什什么意思？你们线上系统load⼀一般多少？如果⼀一个4核机器器，你认为多**
  **少load是⽐比较正常的？top命令⾥里里⾯面按⼀一下1会发⽣生什什么?**
8. **top命令⾥里里⾯面，有时候所有进程的CPU使⽤用率加起来超过100%是怎么回**
  **事？**
> 某些线程做了一些死循环的操作,首先通过top -p 定位到线程号,然后根据线程号找到对应的线程执行jstack -p

1. **还有哪些查看系统性能或者供你发现问题的命令？你⼀一般是看哪个参**
  **数？**
2. **想看某个进程打开了了哪些⽹网络连接是什什么命令？⾥里里⾯面连接的状态你⽐比较**
  **关⼼心哪⼏几种？**
#  偏题
1. **有没有做过Linux系统参数⽅方⾯面的优化，⼤大概优化过什什么？**
2. **系统参数⾥里里⾯面有个叫做backlog的可以⽤用来⼲干什什么？**
3. **查看⽹网络连接发现好多TIME_WAIT 可能是什什么原因？对你的应⽤用会有什什**
  **么影响？你会选择什什么样的⽅方式来减少这些TIME_WAIT**
4. **可否介绍⼀一下TCP三次握⼿手的过程，如果现在有个⽹网络程序，你⽤用第三⽅方**
  **的library来发送数据，你怀疑这个library发送的数据有问题，那么怎么来验**
  **证？tcpdump导出的⽂文件你⼀一般是怎么分析的？**
5. KeepAlive是⽤用来⼲干什什么的？这样的好处是什什么？
  Redis
# 开发
1. 缓存穿透可以介绍⼀一下么？你认为应该如何解决这个问题

> 就是用户通过查找一个不存在的key导致缓存被击穿,流量直接落到数据库层。
>
> 将用户查询到不存在的key查询出来的数据为null的话,也进行缓存,并且设置一个有效时间
>
> 

2. 你是怎么触发缓存更更新的？(⽐比如设置超时时间(被动⽅方式), ⽐比如更更新的时

候主动update)？如果是被动的⽅方式如何控制多个⼊入⼝口同时触发某个缓存更更
新？

> dml操作的时候,更新完数据库之后会同时同步到缓存中。避免脏数据

3. 你们⽤用Redis来做什什么？为什什么不不⽤用其他的KV存储例例如Memcached,

Cassandra等?

> 分布式缓存嘛...比如我需要缓存在多个应用间共享的时候.比如登录的时候的session啊...一些其他场景吧..
>
> 1. redis的数据结构比较多,有map.list.string.操作起来方便,性能更高吧,还提供一些原子性操作啊等等

4. **你们⽤用什什么Redis客户端? Redis⾼高性能的原因⼤大概可以讲⼀一些?**

> 

5. **你熟悉哪些Redis的数据结构? zset是⼲干什什么的? 和set有什什么区别?**
6. Redis的hash, 存储和获取的具体命令叫什什么名字?

> hset,hget

7. **LPOP和BLPOP的区别?**

> 链表

8. **Redis的有⼀一些包含SCAN关键字的命令是⼲干嘛的? SCAN返回的数据量量是**

**固定的吗?**

> 

9. **Redis中的Lua有没有使⽤用过? 可以⽤用来做什什么? 为什什么可以这么⽤用?**
10. **Redis的Pipeline是⽤用来⼲干什什么的?**

# 运维

1. **Redis持久化⼤大概有⼏几种⽅方式? aof和rdb的区别是什什么? AOF有什什么优缺**
  **点吗?**
2. **Redis Replication的⼤大致流程是什什么? bgsave这个命令的执⾏行行过程?**

# 偏题

1. 如果有很多 KV数据要存储到Redis, 但是内存不不⾜足, 通过什什么⽅方式可以缩

减内存? 为什什么这样可以缩⼩小内存?

2. Redis中List, HashTable都⽤用到了了ZipList, 为什什么会选择它?

监控、稳定性

3. 业务⽇日志是通过什什么⽅方式来收集的？

> CAT 大众点评开源的一款日志监控吧 

3. 线上机器器如何监控？采⽤用什什么开源产品或者⾃自研的产品？它是分钟级的还

是秒级的？

5. 如果让你来想办法收集⼀一个JAVA后端应⽤用的性能数据，你会在意哪些⽅方

⾯面? 你会选择什什么样的⼯工具、思路路来收集?

6. ⼀一般你调⽤用第三⽅方的时候会不不会监控调⽤用情况？

