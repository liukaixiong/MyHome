# 流量过高定位

## 如何定位哪个进程流量过高?

```shell
yum install nethogs
nethogs
```

使用介绍: 

```xml
m : Cycle between display modes (kb/s, kb, b, mb) 切换网速显示单位
r : Sort by received. 按接收流量排序
s : Sort by sent. 按发送流量排序
q : Quit and return to the shell prompt. 退出NetHogs命令工具
```

**NetHogs 命令行参数**

常用的参数：

> -d delay for refresh rate. 数据刷新时间 如nethogs -d 1 就是每秒刷新一次
>
> -h display available commands usage. 显示命名帮助、使用信息
>
> -p sniff in promiscious mode (not recommended).
>
> -t tracemode.
>
> -V prints Version info.

演示例子：

\#5秒刷新一次数据

nethogs -d 5

\#监控网卡eth0数据

nethogs eth0

\#同时监视eth0和eth1接口

nethogs eth0 eth1

\#将监控日志写入日志文件
nethogs >>test.log



# 使用Linux命令查看

## 查看网卡使用情况

```shell
sar -n DEV 2 10 
```

- IFACE : LAN接口，网络设备的名称
- rxpck/s : 每秒钟接收的数据包
- txpck/s : 每秒钟发送的数据包
- rxbyt: 每秒钟接收的字节数
- txbyt : 每秒钟发送的字节数
- rxcmp : 每秒钟接收的压缩数据包
- txcmp/s : 每秒钟发送的压缩数据包
- rxmcst/s : 每秒钟接收的多播数据包

如果想进一步验证网卡是否已经到了极限值，可以使用iperf3命令查看。还可以使用netstat -t 查看网卡的连接情况，看是否有大量连接造成阻塞。

然后使用iostat 查看磁盘使用情况:

```shell
iostat -xdm 1
```

定位网卡、磁盘、CPU是否到达极限。





